<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ØªØ¬Ø± Hashtag</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Cairo', sans-serif;
direction: rtl;
background: #0a0a0a;
color: #fff;
padding: 20px;
text-align: center;
}

h1 {
margin-bottom: 30px;
color: #ff0055;
font-size: 28px;
}

.controls {
display: flex;
gap: 10px;
max-width: 500px;
margin: auto;
flex-wrap: wrap;
justify-content: center;
}

.controls select,
.controls button {
padding: 12px;
border-radius: 8px;
border: 1px solid #333;
background: #111;
color: #fff;
font-family: 'Cairo', sans-serif;
cursor: pointer;
font-size: 14px;
}

.controls select {
flex: 1;
min-width: 150px;
}

.controls button {
background: #ff0055;
border: none;
font-weight: bold;
transition: all 0.3s;
}

.controls button:hover {
background: #cc0044;
transform: scale(1.05);
}

.controls button:disabled {
background: #555;
cursor: not-allowed;
}

#cartBtn {
position: fixed;
top: 20px;
right: 20px;
width: 60px;
height: 60px;
border-radius: 50%;
background: #333;
display: flex;
align-items: center;
justify-content: center;
font-size: 24px;
cursor: pointer;
z-index: 999;
box-shadow: 0 4px 15px rgba(0,0,0,0.5);
transition: all 0.3s;
}

#cartBtn:hover {
transform: scale(1.1);
}

#cartCount {
position: absolute;
top: 5px;
right: 5px;
background: #ff0055;
border-radius: 50%;
padding: 3px 7px;
font-size: 12px;
font-weight: bold;
}

#cartPopup {
visibility: hidden;
opacity: 0;
position: fixed;
top: 90px;
right: 20px;
width: 320px;
max-height: 500px;
overflow-y: auto;
background: #111;
border-radius: 15px;
padding: 20px;
border: 1px solid #444;
box-shadow: 0 0 20px rgba(0,0,0,0.7);
transition: all 0.3s;
z-index: 998;
}

#cartPopup.show {
visibility: visible;
opacity: 1;
}

#cartPopup h3 {
color: #ff0055;
margin-bottom: 15px;
}

#cartItems {
list-style: none;
padding: 0;
margin: 15px 0;
}

#cartItems li {
border-bottom: 1px solid #333;
padding: 10px 0;
display: flex;
justify-content: space-between;
align-items: center;
font-size: 14px;
}

#cartItems input {
width: 50px;
padding: 5px;
border-radius: 5px;
border: 1px solid #333;
background: #222;
color: #fff;
text-align: center;
}

.total {
margin: 20px 0;
padding: 15px;
background: #222;
border-radius: 8px;
color: #ff0055;
font-size: 20px;
font-weight: bold;
}

#cartPopup button {
width: 100%;
padding: 12px;
margin-top: 10px;
border: none;
border-radius: 8px;
font-family: 'Cairo', sans-serif;
font-weight: bold;
cursor: pointer;
transition: all 0.3s;
font-size: 14px;
}

#payBtn {
background: #0070ff;
color: #fff;
}

#payBtn:hover {
background: #0056cc;
}

#payBtn:disabled {
background: #555;
cursor: not-allowed;
}

#clearBtn {
background: #555;
color: #fff;
}

#clearBtn:hover {
background: #333;
}

.loading {
display: none;
text-align: center;
color: #aaa;
padding: 15px;
font-size: 14px;
}

.loading.show {
display: block;
}

.hint-note {
margin-top: 14px;
font-size: 12px;
color: #999;
line-height: 1.6;
opacity: 0;
transform: translateY(-6px);
animation: hintFade 1.4s ease forwards;
}

.hint-note strong {
color: #ff0055;
font-weight: 700;
}

@keyframes hintFade {
to {
opacity: 0.9;
transform: translateY(0);
}
}
</style>
</head>

<body>

<h1>ğŸ–¤ Ù…ØªØ¬Ø± Hashtag</h1>

<div class="controls">
<select id="shirtSelect">
<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬ â–¼</option>
<option>LIGHT 1</option>
<option>LIGHT 2</option>
<option>LIGHT 3</option>
<option>LIGHT 4</option>
<option>LIGHT 5</option>
<option>LIGHT 6</option>
<option>LIGHT 7</option>
<option>LIGHT 8</option>
<option>LIGHT 9</option>
<option>LIGHT 10</option>
<option>LIGHT 11</option>
<option>LIGHT 12</option>
<option>LIGHT 13</option>
<option>LIGHT 14</option>
<option>LIGHT 15</option>
<option>LIGHT 16</option>
<option>LIGHT 17</option>
<option>LIGHT 18</option>
<option>LIGHT 19</option>
<option>LIGHT 20</option>
<option>LIGHT 21</option>
<option>LIGHT 22</option>
<option>LIGHT 23</option>
<option>LIGHT 24</option>
<option>LIGHT 25</option>
<option>LIGHT 26</option>
<option>LIGHT 27</option>
<option>LIGHT 28</option>
<option>LIGHT 29</option>
<option>LIGHT 30</option>
<option>LIGHT 31</option>
<option>LIGHT 32</option>
<option>LIGHT 33</option>
<option>LIGHT 34</option>
<option>LIGHT 35</option>
<option>LIGHT 36</option>
<option>LIGHT 37</option>
<option>LIGHT 38</option>
<option>LIGHT 39</option>
</select>
<select id="sizeSelect">
<option value="">Ø§Ù„Ù…Ù‚Ø§Ø³ â–¼</option>
<option>Small</option>
<option>Medium</option>
<option>Large</option>
<option>2 Large</option>
<option>3 Large</option>
</select>

<button onclick="addToCart()">ğŸ›’ Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
</div>

<p class="hint-note">
Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬ ÙˆØ§Ù„Ù…Ù‚Ø§Ø³ Ø«Ù… Ø§Ø¶ØºØ· <strong>"Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©"</strong>.
Ø«Ù… Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ø®ØªØ± <strong>"Ø§Ø¯ÙØ¹ Ø§Ù„Ø¢Ù†"</strong>.
</p>

<div id="cartBtn" onclick="toggleCart()">
ğŸ›’
<span id="cartCount">0</span>
</div>

<div id="cartPopup">
<h3>ğŸ–¤ Ø³Ù„ØªÙƒ</h3>
<ul id="cartItems"></ul>
<div class="total">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="cartTotal">0</span> AED</div>
<div class="loading" id="loading">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</div>
<button id="payBtn" onclick="saveAndPay()">ğŸ’³ Ø§Ø¯ÙØ¹ Ø§Ù„Ø¢Ù†</button>
<button id="clearBtn" onclick="clearCart()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©</button>
</div>

<script>
// Ø±Ø§Ø¨Ø· Google Apps Script
const API_ENDPOINT = "https://script.google.com/macros/s/AKfycbz5eDWQGmfPYrztCrzFQ8Xk7DCDK7A6oZlmRgCXVf2989yupJPo7UVnpCEJpFMY0Psm8Q/usercallback";

// Ø±Ø§Ø¨Ø· ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ Ø¹Ù„Ù‰ GitHub
const GITHUB_PAYMENT_PAGE = "https://yourname.github.io/hashtag-payment/"; // Ø³Ù†ØºÙŠØ±Ù‡ Ø¨Ø¹Ø¯ÙŠÙ†

let cart = [];

function updateCart() {
const list = document.getElementById('cartItems');
let total = 0;

if (cart.length) {
list.innerHTML = cart.map((item, i) => {
total += item.price * item.qty;
return `
<li>
<div>
<strong>${item.name}</strong><br>
<small>Ø§Ù„Ù…Ù‚Ø§Ø³: ${item.size} | Ø§Ù„Ø³Ø¹Ø±: ${item.price} AED</small>
</div>
<input type="number" min="1" value="${item.qty}" onchange="changeQty(${i}, this.value)">
</li>`;
}).join('');
} else {
list.innerHTML = '<li style="color:#777;border:none;">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</li>';
}

document.getElementById('cartTotal').innerText = total.toFixed(2);
document.getElementById('cartCount').innerText = cart.reduce((a, b) => a + b.qty, 0);
}

function addToCart() {
const shirt = document.getElementById('shirtSelect').value;
const size = document.getElementById('sizeSelect').value;

if (!shirt) {
alert('âš ï¸ Ø§Ø®ØªØ± Ø§Ù„Ù‚Ù…ÙŠØµ Ø£ÙˆÙ„Ø§Ù‹');
return;
}
if (!size) {
alert('âš ï¸ Ø§Ø®ØªØ± Ø§Ù„Ù…Ù‚Ø§Ø³ Ø£ÙˆÙ„Ø§Ù‹');
return;
}

const price = 89;
const exist = cart.find(i => i.name === shirt && i.size === size);

if (exist) {
exist.qty++;
} else {
cart.push({ name: shirt, size: size, price: price, qty: 1 });
}

updateCart();
alert('âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©!');
}

function changeQty(index, value) {
const qty = parseInt(value);
if (qty > 0) {
cart[index].qty = qty;
} else {
cart.splice(index, 1);
}
updateCart();
}

function clearCart() {
if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©ØŸ')) {
cart = [];
updateCart();
}
}

function toggleCart() {
document.getElementById('cartPopup').classList.toggle('show');
}

async function saveAndPay() {
if (cart.length === 0) {
alert('âš ï¸ Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©');
return;
}

const payBtn = document.getElementById('payBtn');
const loading = document.getElementById('loading');

payBtn.disabled = true;
loading.classList.add('show');

try {
const cartData = {
action: 'saveCart',
items: JSON.stringify(cart),
total: cart.reduce((a, b) => a + b.price * b.qty, 0),
timestamp: Date.now()
};

const params = new URLSearchParams(cartData);
const response = await fetch(API_ENDPOINT + '?' + params.toString());
const result = await response.json();

if (result.success) {
// Ø§Ù†ØªÙ‚Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ Ø¹Ù„Ù‰ GitHub
window.location.href = GITHUB_PAYMENT_PAGE + "?sessionId=" + result.sessionId;
} else {
throw new Error(result.error || 'ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
}

} catch (error) {
alert('âŒ Ø®Ø·Ø£: ' + error.message);
payBtn.disabled = false;
loading.classList.remove('show');
}
}
</script>
</body>
</html>